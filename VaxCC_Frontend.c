/*	 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 	 	Vax C preprocessor and Compiler		Front end by David Gladstone 3/8/94	 	1.0a1			- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 	Description		Provides a macintosh user interface over a unix port.  It uses	the Screen Manager to provide the user interface.	- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - *//* = = = = = = = = = = = = = = INCLUDES = = = = = = = = = = = = = = = = */#include <Memory.h>#include "MacScreen.h"#include "Compiler.h"#include "Globals.h"/*	- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 	DefaultFixMenus		Adjusts the menus to a standard state when no window changes	the menu state.		Also adjusts the button palette to reflect the same state as well	since they are basically the same thing. 	- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */	static pascal void 	DefaultFixMenus( void )	{	DisableItem( FileMenu, PrintCmd );	DisableItem( FileMenu, PrintOneCmd );	DisableItem( FileMenu, DocumentSetupCmd );	if( msFrontWindow() == nil )		{		DisableItem( FileMenu, CloseCmd );		DisableItem( EditMenu, 0 );		// Since this is not implemented yet.		}	else		{		EnableItem( FileMenu, CloseCmd );		DisableItem( EditMenu, 0 );		// Since this is not supported yet.		}	}/*	- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 	HandleFileMenu		Handles the File Menu	- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */	static pascal void HandleFileMenu( short item )	{			switch( item )		{		case CompileCmd:			if ( CompileFile() != noErr )				SysBeep(5);			break;					case PreprocessCmd:			if ( PreprocessFile() != noErr )				SysBeep(5);						break;					case CloseCmd:			(void) msCloseWindow( msFrontWindow() );			break;				case PrintCmd:			/* Currently not implemented */			break;						case PrintOneCmd:			/* Currently not implemented */			break;					case DocumentSetupCmd:			/* Currently not implemented */			break;					case QuitCmd:			msStopEventLoop();		default:			;		}	}/*	- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 	HandleEditMenu		Handles the Edit Menu.	Currently not implemented.	- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */	static pascal void HandleEditMenu( short item )	{	msHandleEditMenu( item );	}/*	- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 	HandleAboutWindow		- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */	/* Extracted directly from the rez file:*/#define OK_BUTTON 1#define ABOUT_TEXT 2static pascal long	HandleAboutWindow (msWindow *theWindow, short itemHit, short unused1, Ptr unused2, long unused3){	switch( itemHit )	{		case OK_BUTTON:			(void)msRemoveWindow( theWindow );			break;					default: break;	}		return( 0 );}/*	- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 	HandleAboutCmd		Handles the 'about…' command in the apple menu.	- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */	static pascal void	HandleAboutCmd( void )	{	(void) msGetWindow(aboutWindowID, (ProcPtr)*HandleAboutWindow, 0);	}/*	- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 	SetupMenus		Installs all the menus needed. Callback procedures are installed	and the Screen Manager calls them when items from those menus are installed.	- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */	static void SetupMenus( void )	{	msInstallAppleMenu( *HandleAboutCmd );	FileMenu = GetMenu( fileMenuID );	msInstallMenu( FileMenu, *HandleFileMenu, FALSE );	EditMenu = GetMenu( editMenuID );	msInstallMenu( EditMenu, *HandleEditMenu, FALSE );	msSetDefaultFixMenus( *DefaultFixMenus );	msDrawMenuBar( TRUE );	}/*	- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 	InitialiseExtraItems	Initialises extra items that the screen manager doesn't	automatically include. 	- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */	static void InitialiseExtraItems( void )	{	}/*	- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 	InitMacintosh		Description		Whole bunch of garb to initialise the Mac toolbox.	- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */#define kExtraStackSize 32768static void InitMacintosh( void )    {        // Reserve some stack space    SetApplLimit( GetApplLimit() - kExtraStackSize );    MaxApplZone();    InitGraf( &qd.thePort );    InitFonts();    FlushEvents( everyEvent, 0 );    InitWindows();    InitMenus();    TEInit();    InitDialogs( 0L );    }/*	- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 	MAIN PROGRAM	- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - */void main( void )	{	InitMacintosh();		msInitialise( kmsDefaultInitialiseParameters );	InitialiseExtraItems();		SetupMenus();		msStartEventLoop();	msShutdown();	}